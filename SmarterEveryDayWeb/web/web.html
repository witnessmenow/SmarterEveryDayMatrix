<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <link rel="stylesheet" href="bootstrap.min.css">
    </head>
  <body onload="pageLoaded()">
    <nav class="navbar navbar-dark bg-dark">
        <span class="navbar-brand h1">Smarter Every Day Matrix Display</span>
        <form class="form-inline">
            <div class="input-group">
              <div class="input-group-prepend">
                <span class="input-group-text" id="basic-addon1">Server:</span>
              </div>
              <input type="text" class="form-control" id="serverLocation">
              <button  type="button" class="btn btn-outline-success my-2 my-sm-0" onclick='setServerLocation()'>Set</button>
            </div>
          </form>
    </nav>
    <div class="container">
        <!-- Text Area-->
        <div class="row">
            <h3>Message:</h3>
        </div>
        <div class="row">
            <textarea class="form-control" id="messageBox" rows="3"></textarea>
        </div>
        <div class="row">
            Add Emoji:
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("ü™ê")'>ü™ê</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("ü¶ï")'>ü¶ï</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("ü¶ñ")'>ü¶ñ</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("üöÄ")'>üöÄ</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("üåï")'>üåï</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("üåô")'>üåô</button>
            <button type="button" style='margin: 0.5em; font-size: large;' class="btn btn-default" onclick='addEmojiToText("üî≠")'>JWT</button>
        </div>
        <div class="row">
            <div class="col-6">
                <button id="messageButton" type="button" class="btn btn-default" style="height: 100%; width: 100%" onclick='sendMessage()'>Scroll Message</button>
            </div>
            <div class="col-3">
                <button id="messageButton" type="button" class="btn btn-default" style="height: 100%; width: 100%" onclick='sendVerticalMessage()'>Vertical</button>
            </div>
            <div class="col-3">
                <button id="messageButton" type="button" class="btn btn-default" style="height: 100%; width: 100%" onclick='sendStaticMessage()'>Static</button>
            </div>
        </div>
    </div>
    <hr>
    <div class="container"> 
        <div class="row">
            <h3>Count Down:</h3>
        </div>
        <div class="row">
            <div class="col">
                <input type="number" class="form-control" id="countDownBox">
            </div>
            <div class="col">
                <button id="countDownButton" type="button" class="btn btn-default" style="height: 100%; width: 100%" onclick='sendCountDown()'>Start Count Down</button>
            </div>
        </div>
    </div>
    <hr>
    <div class="container"> 
        <div class="row">
            <h3>Goal:</h3>
        </div>
        <div class="row" style="margin-bottom: 1em;">
            <div class="col-3">
                <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="currentLabel">Current:</span>
                    </div>
                    <input type="number" class="form-control" id="goalCurrent" value="0" oninput="currentChanged()" onchange="currentChanged()">
                  </div>
            </div>
            <div class="col-6">
                <input type="range" style="width:100%" class="form-range" id="goalRange" oninput="rangeChanged()" onchange="rangeChanged()" value="0" >
            </div>
            <div class="col-3">
                <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="currentLabel">Out of:</span>
                    </div>
                    <input type="number" class="form-control" id="goalGoal" oninput="goalChanged()" onchange="goalChanged()" value="100">
                  </div>
            </div>
        </div>
        <div class="row" style="margin-bottom: 1em;">
            <div class="col">
                <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="leftEmojiLabel">Left Emoji:</span>
                    </div>
                    <select style="font-size: large;" class="custom-select" id="leftEmoji">
                        <option selected value="0" >ü¶ñ</option>
                        <option value="1">ü¶ï</option>
                        <option value="2">üöÄ</option>
                        <option value="3">üåï</option>
                        <option value="4">üåô</option>
                        <option value="5">ü™ê</option>
                        <option value="6">JWT</option>
                      </select>
                  </div>
            </div>
            <div class="col">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text" id="rightEmojiLabel">Right Emoji:</span>
                      </div>
                      <select style="font-size: large;" value="5" class="custom-select" id="rightEmoji">
                          <option value="0" >ü¶ñ</option>
                          <option value="1">ü¶ï</option>
                          <option value="2">üöÄ</option>
                          <option value="3">üåï</option>
                          <option value="4">üåô</option>
                          <option selected value="5">ü™ê</option>
                          <option value="6">JWT</option>
                          <option value="-1">  </option>
                        </select>
                    </div>
            </div>
        </div>
        <div class="row">
            <button id="goalButton" type="button" class="btn btn-default" style="height: 100%; width: 100%" onclick='sendGoal()'>Send Goal</button>
        </div>
    </div>
    <hr>
    </div>
    <script src="jquery.min.js"></script>
    <script>

        var serverLocation = ''

        function pageLoaded(){
            setServerLocation();
            currentChanged();
            rangeChanged();
            goalChanged();

        }

        function setServerLocation() {
            var serverAddressBox = document.getElementById('serverLocation');
            serverLocation = serverAddressBox.value;
        }

        function addEmojiToText(emojiText){
            var messageBox = document.getElementById('messageBox');
            insertAtCursor(messageBox, emojiText)
            //messageBox.value = messageBox.value + emojiText;
        }

      function sendMessage(){
        var messageBox = document.getElementById('messageBox');
        var message = messageBox.value;
        //$.post("message", message)
        var url = serverLocation + "message?msg=" + encodeURIComponent(message);
        $.ajax({"url": url})
        
      }

      function sendVerticalMessage(){
        var messageBox = document.getElementById('messageBox');
        var message = messageBox.value;
        //$.post("message", message)
        var url = serverLocation + "vertical?msg=" + encodeURIComponent(message);
        $.ajax({"url": url})
        
      }

      function sendStaticMessage(){
        var messageBox = document.getElementById('messageBox');
        var message = messageBox.value;
        //$.post("message", message)
        var url = serverLocation + "static?msg=" + encodeURIComponent(message);
        $.ajax({"url": url})
        
      }

      function sendCountDown(){
        var countDownNumberBox = document.getElementById('countDownBox');
        var countDownValue = countDownNumberBox.value;
        //$.post("message", message)
        var url = serverLocation + "count?number=" + encodeURIComponent(countDownValue);
        $.ajax({"url": url})
        
      }

      function rangeChanged(){

        //Updating the current value

        var goalRange = document.getElementById('goalRange');

        var goalCurrent = document.getElementById('goalCurrent');
        goalCurrent.value = goalRange.value;
        
      }

      function currentChanged(){

        //Updating the value of the range

        var goalCurrent = document.getElementById('goalCurrent');

        var goalRange = document.getElementById('goalRange');
        goalRange.value = goalCurrent.value;

        }

      function goalChanged(){

        //Updating the range max

        var goalGoal = document.getElementById('goalGoal');
        var goalGoalValue = goalGoal.value;

        var goalRange = document.getElementById('goalRange');
        goalRange.max = goalGoalValue;

        goalRange.step = goalGoalValue / 20;

        rangeChanged();

    }

      function sendGoal(){
        var goalCurrent = document.getElementById('goalCurrent');
        var goalCurrentValue = goalCurrent.value;

        var goalGoal = document.getElementById('goalGoal');
        var goalGoalValue = goalGoal.value;

        var leftEmojiSelect = document.getElementById('leftEmoji');
        var leftEmojiIndex = leftEmojiSelect.value;

        var rightEmojiSelect = document.getElementById('rightEmoji');
        var rightEmojiIndex = rightEmojiSelect.value;

        var url = serverLocation 
                    + "goal?lower=" + encodeURIComponent(goalCurrentValue) 
                    + "&higher=" + encodeURIComponent(goalGoalValue) 
                    + "&firstEmojiIndex=" + encodeURIComponent(leftEmojiIndex) 
                    + "&secondEmojiIndex=" + encodeURIComponent(rightEmojiIndex);
        $.ajax({"url": url})
        
      }

      function insertAtCursor(myField, myValue) {
        //IE support
        if (document.selection) {
            myField.focus();
            sel = document.selection.createRange();
            sel.text = myValue;
        }
        //MOZILLA and others
        else if (myField.selectionStart || myField.selectionStart == 0) {
            var startPos = myField.selectionStart;
            var endPos = myField.selectionEnd;
            myField.value = myField.value.substring(0, startPos)
                + myValue
                + myField.value.substring(endPos, myField.value.length);
        } else {
            myField.value += myValue;
        }
    }
    
    </script>
    <script> function makeAjaxCall(url){$.ajax({"url": url})}</script>
    <!--<script>
       document.addEventListener('keydown', function(event) {
          if(event.keyCode == 37) {
              //Left Arrow
              makeAjaxCall("left");            
          }
          else if(event.keyCode == 39) {
              //Right Arrow
              makeAjaxCall("right");   
          } else if(event.keyCode == 38) {
              //Up Arrow
              makeAjaxCall("forward");   
          } else if(event.keyCode == 40) {
              //Down Arrow
              makeAjaxCall("back");   
          }
      });

      document.addEventListener('keyup', function(event) {
          if(event.keyCode == 37 ||event.keyCode == 39 ) {
              //Left or Right Arrow
              makeAjaxCall("steerStop");            
          }
          else if(event.keyCode == 38 ||event.keyCode == 40 ) {
              //Up or Down Arrow
              makeAjaxCall("driveStop");            
          }
      });
    </script>-->
  </body>
</html>